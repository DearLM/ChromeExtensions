class e{constructor(){}init(){let t=this;var e=document.createElement("style");this.styleId=Date.now(),e.id=this.styleId,e.textContent="*:hover {outline: 2px solid red;}",document.head.appendChild(e),this.mouseoverHandler=e=>{t.x=e.clientX,t.y=e.clientY},document.addEventListener("mouseover",this.mouseoverHandler)}htmlToMarkdownInMouse(){return t(document.elementFromPoint(this.x,this.y),[])}destroy(){var e=document.getElementById(this.styleId);e&&e.remove(),document.removeEventListener("mouseover",this.mouseoverHandler)}}function t(e,o){var t=new TurndownService;return t.addRule("filterByClass",{filter:function(e,t){var n=o;if(e.classList)for(var r=0;r<n.length;r++)if(e.classList.contains(n[r]))return!0;return!1},replacement:function(e,t){return""}}),t.addRule("codeBlock",{filter:function(e,t){return"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t){return"\n```\n"+e+"\n```\n"}}),t.turndown(e)}let r=new e;chrome.runtime.onMessage.addListener((e,t,n)=>{"open"===e.cmd?r.init():"shutdown"===e.cmd?r.destroy():"html2md"===e.cmd&&(e=r.htmlToMarkdownInMouse(),chrome.runtime.sendMessage({cmd:"copyMd",message:e}))}),window.addEventListener("load",function(){chrome.runtime.sendMessage({cmd:"load"},e=>{chrome.runtime.lastError?console.error("发生错误:",chrome.runtime.lastError):e&&r.init()})});