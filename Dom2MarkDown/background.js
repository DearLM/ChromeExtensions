let n=!1;chrome.action.onClicked.addListener(e=>{(n=!n)?(o(e.id),chrome.action.setIcon({path:"md-on.png"})):(c(e.id),chrome.action.setIcon({path:"md-off.png"}))});const t="html2md";function o(e){chrome.contextMenus.create({id:t,title:"复制md",contexts:["all"]}),chrome.tabs.sendMessage(e,{cmd:"open"}),chrome.contextMenus.onClicked.addListener(d)}function c(e){chrome.contextMenus.remove(t),chrome.tabs.sendMessage(e,{cmd:"shutdown"}),chrome.contextMenus.onClicked.removeListener(d)}let d=(e,o)=>{e.menuItemId==t&&(chrome.tabs.sendMessage(o.id,{cmd:"html2md"}),chrome.windows.create({url:"popup.html",type:"popup",width:1024,height:768}))},m;function e(){n=!1,chrome.action.setIcon({path:"md-off.png"})}chrome.runtime.onMessage.addListener((e,o,t)=>{"load"===e.cmd?t(n):"copyMd"===e.cmd?m=e.message:"getMd"===e.cmd&&(console.log(m),t(m))});